#!/usr/bin/env node
'use strict';

process.title = 'cv2pdf';

var minimist = require('minimist');
var Cv2Pdf = require('../lib');

function getCommandLineOptions() {
  return minimist(process.argv.slice(2), {
    alias: {
      o: 'out',
      c: 'css',
      s: 'save-html',
      h: 'help'
    },
    boolean: ['s']
  });
}

function printDescription() {
  console.log('Convert a Markdown CV to PDF');
}

function printUsage() {
  console.log(
    'Usage: cv2pdf ' +
    '[-h|--help] ' +
    '[-o|--out=cv.pdf] ' +
    '[-c|--css=style.css] ' +
    '[-s|--save-html] ' +
    'cv.md'
  );
}

var opts = getCommandLineOptions();

if (opts.h || opts._.length === 0) {
  printDescription();
  printUsage();
  process.exit(opts.h ? 0 : 1);
}

var markdownFile = opts._[0];
try {
  var cv2pdf = new Cv2Pdf(markdownFile, {
    out: opts.o,
    css: opts.c,
    saveHtml: opts.s
  });
  cv2pdf.convert();
} catch (e) {
  console.error(e.message);
  printUsage();
  process.exit(1);
}
